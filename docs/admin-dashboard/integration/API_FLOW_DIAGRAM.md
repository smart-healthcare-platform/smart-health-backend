# Admin Dashboard API Flow Diagrams

## ğŸ“Š Overview

This document provides visual diagrams showing how data flows through the system for admin dashboard functionality.

---

## ğŸ”„ Diagram 1: Dashboard Stats Request Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Admin Dashboard (Browser)                     â”‚
â”‚                                                                      â”‚
â”‚  [User clicks "Dashboard" or page loads]                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ HTTP GET /v1/admin/dashboard/stats
                               â”‚ Authorization: Bearer <JWT_TOKEN>
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API Gateway (Port 8080)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Step 1: Admin Authentication Middleware                       â”‚  â”‚
â”‚  â”‚  - Verify JWT token                                           â”‚  â”‚
â”‚  â”‚  - Check ADMIN role                                           â”‚  â”‚
â”‚  â”‚  - Attach user to request                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚                                      â”‚
â”‚                               â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Step 2: Check Redis Cache                                     â”‚  â”‚
â”‚  â”‚  Key: "admin:stats:v1"                                        â”‚  â”‚
â”‚  â”‚  TTL: 30 seconds                                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                               â”‚                                      â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                    â”‚                     â”‚                          â”‚
â”‚              Cache HIT             Cache MISS                        â”‚
â”‚                    â”‚                     â”‚                          â”‚
â”‚                    â”‚                     â–¼                          â”‚
â”‚                    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                    â”‚    â”‚ Step 3: Dashboard Aggregator Service   â”‚  â”‚
â”‚                    â”‚    â”‚                                        â”‚  â”‚
â”‚                    â”‚    â”‚ Parallel API Calls:                    â”‚  â”‚
â”‚                    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                    â”‚                     â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                     â”‚
                     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚    â”‚                â”‚                â”‚
                     â”‚    â–¼                â–¼                â–¼
                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  â”‚ Patient  â”‚  â”‚  Doctor  â”‚  â”‚Appointmt â”‚
                     â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚
                     â”‚  â”‚  :8082   â”‚  â”‚  :8083   â”‚  â”‚  :8084   â”‚
                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚       â”‚              â”‚              â”‚
                     â”‚       â”‚ Internal     â”‚ Internal     â”‚ Internal
                     â”‚       â”‚ Auth         â”‚ Auth         â”‚ Auth
                     â”‚       â”‚              â”‚              â”‚
                     â”‚       â–¼              â–¼              â–¼
                     â”‚  GET /v1/admin/ GET /v1/admin/ GET /v1/admin/
                     â”‚  patients/stats  doctors/stats  appointments/stats
                     â”‚       â”‚              â”‚              â”‚
                     â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
                     â”‚  â”‚                                        â”‚
                     â”‚  â”‚         More Services...               â”‚
                     â”‚  â”‚                                        â”‚
                     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
                     â”‚  â”‚  â”‚ Billing  â”‚      â”‚ Medicine â”‚       â”‚
                     â”‚  â”‚  â”‚ Service  â”‚      â”‚ Service  â”‚       â”‚
                     â”‚  â”‚  â”‚  :8085   â”‚      â”‚  :8086   â”‚       â”‚
                     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
                     â”‚  â”‚       â”‚                  â”‚             â”‚
                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚          â”‚                  â”‚
                     â”‚          â–¼                  â–¼
                     â”‚     Revenue Stats      Medicine Stats
                     â”‚          â”‚                  â”‚
                     â”‚          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                 â”‚
                     â”‚                 â–¼
                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  â”‚ Step 4: Aggregate Results              â”‚
                     â”‚  â”‚  - Combine all service responses       â”‚
                     â”‚  â”‚  - Handle partial failures gracefully  â”‚
                     â”‚  â”‚  - Calculate derived metrics           â”‚
                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                 â”‚
                     â”‚                 â–¼
                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  â”‚ Step 5: Cache Result                   â”‚
                     â”‚  â”‚  redis.set('admin:stats:v1', data, 30) â”‚
                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                 â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ Aggregated Data
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         API Gateway Response                         â”‚
â”‚                                                                      â”‚
â”‚  {                                                                   â”‚
â”‚    "success": true,                                                  â”‚
â”‚    "data": {                                                         â”‚
â”‚      "totalPatients": 15234,                                         â”‚
â”‚      "activeDoctors": 189,                                           â”‚
â”‚      "todayAppointments": 127,                                       â”‚
â”‚      "revenueToday": 45678000,                                       â”‚
â”‚      "patients": { ... },                                            â”‚
â”‚      "doctors": { ... },                                             â”‚
â”‚      "appointments": { ... },                                        â”‚
â”‚      "revenue": { ... },                                             â”‚
â”‚      "timestamp": "2024-01-15T10:30:00Z",                            â”‚
â”‚      "responseTime": 245,                                            â”‚
â”‚      "fromCache": false                                              â”‚
â”‚    }                                                                 â”‚
â”‚  }                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ JSON Response
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Admin Dashboard (Browser)                          â”‚
â”‚                                                                      â”‚
â”‚  [Dashboard UI updates with new data]                               â”‚
â”‚  - KPI Cards refresh                                                â”‚
â”‚  - Charts re-render                                                 â”‚
â”‚  - Loading state -> Data display                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Performance:**
- Cache HIT: ~5-10ms
- Cache MISS: ~200-500ms (parallel service calls)
- Cache invalidation: Event-based (Kafka)

---

## ğŸ”„ Diagram 2: Real-time Update Flow (WebSocket)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Appointment System â”‚  New appointment created
â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 1. Save to Database
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Appointment Service (NestJS)           â”‚
â”‚                                         â”‚
â”‚  appointmentRepository.save(...)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 2. Emit Kafka Event
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Kafka Topic                     â”‚
â”‚  "appointment.created"                  â”‚
â”‚                                         â”‚
â”‚  {                                      â”‚
â”‚    eventType: "appointment.created",    â”‚
â”‚    appointmentId: "apt_123",            â”‚
â”‚    patientId: "pat_456",                â”‚
â”‚    doctorId: "doc_789",                 â”‚
â”‚    timestamp: "2024-01-15T10:30:00Z"    â”‚
â”‚  }                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 3. Kafka Consumer receives event
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         API Gateway - Kafka Consumer                    â”‚
â”‚                                                         â”‚
â”‚  kafkaConsumer.on('appointment.created', (event) => {   â”‚
â”‚    // Step 4: Invalidate cache                         â”‚
â”‚    redis.del('admin:stats:v1');                         â”‚
â”‚    redis.del('admin:appointments:trends:*');            â”‚
â”‚                                                         â”‚
â”‚    // Step 5: Broadcast via Socket.io                  â”‚
â”‚    adminSocket.broadcastAppointmentCreated(event);      â”‚
â”‚  });                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 6. Emit Socket.io Event
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Socket.io Admin Namespace                          â”‚
â”‚      ws://localhost:8080/admin                          â”‚
â”‚                                                         â”‚
â”‚  adminNamespace.to('dashboard').emit(                   â”‚
â”‚    'appointment:created',                               â”‚
â”‚    {                                                    â”‚
â”‚      id: "apt_123",                                     â”‚
â”‚      patient: { name: "John Doe" },                     â”‚
â”‚      doctor: { name: "Dr. Smith" },                     â”‚
â”‚      date: "2024-01-15T14:00:00Z",                      â”‚
â”‚      status: "pending"                                  â”‚
â”‚    }                                                    â”‚
â”‚  );                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ 7. WebSocket Push
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Admin Dashboard (Browser) - Socket.io Client        â”‚
â”‚                                                         â”‚
â”‚  socket.on('appointment:created', (appointment) => {    â”‚
â”‚    // Step 8: Update UI immediately                    â”‚
â”‚    addToRecentAppointments(appointment);               â”‚
â”‚                                                         â”‚
â”‚    // Step 9: Show notification                        â”‚
â”‚    toast.success('New appointment created!');           â”‚
â”‚                                                         â”‚
â”‚    // Step 10: Optionally refresh stats                â”‚
â”‚    refetchDashboardStats();                             â”‚
â”‚  });                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Latency:**
- Event â†’ UI Update: ~50-200ms
- No polling required
- Real-time user experience

---

## ğŸ”„ Diagram 3: Service-to-Service Authentication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              API Gateway                                â”‚
â”‚                                                         â”‚
â”‚  Request from Admin:                                    â”‚
â”‚  GET /v1/admin/dashboard/stats                          â”‚
â”‚  Authorization: Bearer <ADMIN_JWT_TOKEN>                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ Admin verified âœ“
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Dashboard Aggregator Service                       â”‚
â”‚                                                         â”‚
â”‚  const callService = (serviceName, endpoint) => {       â”‚
â”‚    return axios({                                       â”‚
â”‚      url: `${serviceUrl}${endpoint}`,                   â”‚
â”‚      headers: {                                         â”‚
â”‚        'X-Internal-Request': 'true',                    â”‚
â”‚        'X-Gateway-Secret': process.env.GATEWAY_SECRET,  â”‚
â”‚      }                                                  â”‚
â”‚    });                                                  â”‚
â”‚  };                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ Internal Request
          â”‚ X-Internal-Request: true
          â”‚ X-Gateway-Secret: <SECRET>
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Patient Service (NestJS)                    â”‚
â”‚                                                         â”‚
â”‚  @Controller('v1/admin/patients')                       â”‚
â”‚  @UseGuards(InternalGuard)  â† Validates gateway secret â”‚
â”‚  export class AdminController {                         â”‚
â”‚    @Get('stats')                                        â”‚
â”‚    async getStats() {                                   â”‚
â”‚      // Only accessible via API Gateway                â”‚
â”‚      return this.service.getStats();                    â”‚
â”‚    }                                                    â”‚
â”‚  }                                                      â”‚
â”‚                                                         â”‚
â”‚  InternalGuard checks:                                  â”‚
â”‚  1. X-Internal-Request === 'true'                       â”‚
â”‚  2. X-Gateway-Secret === GATEWAY_SECRET                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ âœ“ Authorized
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Database Query                                  â”‚
â”‚                                                         â”‚
â”‚  SELECT COUNT(*) FROM patients;                         â”‚
â”‚  SELECT COUNT(*) FROM patients WHERE is_active = true;  â”‚
â”‚  SELECT COUNT(*) FROM patients                          â”‚
â”‚    WHERE created_at >= CURRENT_DATE;                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ Query Results
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Response to API Gateway                         â”‚
â”‚                                                         â”‚
â”‚  {                                                      â”‚
â”‚    "success": true,                                     â”‚
â”‚    "data": {                                            â”‚
â”‚      "totalPatients": 15234,                            â”‚
â”‚      "activePatients": 8432,                            â”‚
â”‚      "newToday": 23                                     â”‚
â”‚    }                                                    â”‚
â”‚  }                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Security Layers:**
1. **Layer 1:** Admin JWT verification (API Gateway)
2. **Layer 2:** Internal service authentication (Gateway Secret)
3. **Layer 3:** Rate limiting (API Gateway)
4. **Layer 4:** Database permissions

---

## ğŸ”„ Diagram 4: Cache Invalidation Strategy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Event Sources                               â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚               â”‚               â”‚               â”‚
      â–¼               â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Patient  â”‚   â”‚  Doctor  â”‚   â”‚Appointmt â”‚   â”‚ Billing  â”‚
â”‚ Service  â”‚   â”‚ Service  â”‚   â”‚ Service  â”‚   â”‚ Service  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚              â”‚              â”‚              â”‚
     â”‚ Kafka        â”‚ Kafka        â”‚ Kafka        â”‚ Kafka
     â”‚ Event        â”‚ Event        â”‚ Event        â”‚ Event
     â”‚              â”‚              â”‚              â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              API Gateway - Kafka Consumer                        â”‚
â”‚                                                                  â”‚
â”‚  kafkaConsumer.on('patient.registered', () => {                 â”‚
â”‚    redis.del('admin:stats:v1');                                 â”‚
â”‚    redis.del('admin:patients:*');                               â”‚
â”‚  });                                                             â”‚
â”‚                                                                  â”‚
â”‚  kafkaConsumer.on('doctor.created', () => {                     â”‚
â”‚    redis.del('admin:stats:v1');                                 â”‚
â”‚    redis.del('admin:doctors:*');                                â”‚
â”‚  });                                                             â”‚
â”‚                                                                  â”‚
â”‚  kafkaConsumer.on('appointment.created', () => {                â”‚
â”‚    redis.del('admin:stats:v1');                                 â”‚
â”‚    redis.del('admin:appointments:*');                           â”‚
â”‚  });                                                             â”‚
â”‚                                                                  â”‚
â”‚  kafkaConsumer.on('payment.completed', () => {                  â”‚
â”‚    redis.del('admin:stats:v1');                                 â”‚
â”‚    redis.del('admin:revenue:*');                                â”‚
â”‚  });                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Redis Cache                                â”‚
â”‚                                                                  â”‚
â”‚  BEFORE Event:                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ admin:stats:v1 â†’ {totalPatients: 15234, ...}   TTL: 20sâ”‚    â”‚
â”‚  â”‚ admin:patients:growth:30 â†’ {...}               TTL: 55mâ”‚    â”‚
â”‚  â”‚ admin:appointments:trends:7 â†’ {...}            TTL: 40sâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  AFTER Event (patient.registered):                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ admin:stats:v1 â†’ [DELETED] âœ—                          â”‚    â”‚
â”‚  â”‚ admin:patients:growth:30 â†’ [DELETED] âœ—                â”‚    â”‚
â”‚  â”‚ admin:appointments:trends:7 â†’ {...}            TTL: 35sâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  Next request will:                                             â”‚
â”‚  1. Cache MISS â†’ Fetch fresh data                               â”‚
â”‚  2. Re-cache with full TTL                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Cache Keys Pattern:**
- `admin:stats:*` â†’ Invalidate on ANY change
- `admin:patients:*` â†’ Invalidate on patient events
- `admin:doctors:*` â†’ Invalidate on doctor events
- `admin:appointments:*` â†’ Invalidate on appointment events
- `admin:revenue:*` â†’ Invalidate on payment events

---

## ğŸ”„ Diagram 5: Error Handling & Graceful Degradation

```
API Gateway calls 5 services in parallel:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Patient  â”‚  â”‚  Doctor  â”‚  â”‚Appointmt â”‚  â”‚ Billing  â”‚  â”‚ Medicine â”‚
â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚  â”‚ Service  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚             â”‚             â”‚             â”‚             â”‚
     â–¼             â–¼             â–¼             â–¼             â–¼
    âœ“ OK         âœ“ OK          âœ“ OK         âœ— TIMEOUT     âœ— ERROR
  (150ms)       (200ms)       (180ms)        (5000ms)      (Error)
     â”‚             â”‚             â”‚             â”‚             â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Promise.allSettled() Results                          â”‚
â”‚                                                                  â”‚
â”‚  [                                                               â”‚
â”‚    { status: 'fulfilled', value: { totalPatients: 15234 } },    â”‚
â”‚    { status: 'fulfilled', value: { activeDoctors: 189 } },      â”‚
â”‚    { status: 'fulfilled', value: { todayAppointments: 127 } },  â”‚
â”‚    { status: 'rejected', reason: 'Request timeout' },           â”‚
â”‚    { status: 'rejected', reason: 'Service unavailable' }        â”‚
â”‚  ]                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Graceful Degradation Logic                         â”‚
â”‚                                                                  â”‚
â”‚  const extractData = (result) => {                              â”‚
â”‚    if (result.status === 'fulfilled') {                         â”‚
â”‚      return result.value.data;                                  â”‚
â”‚    }                                                             â”‚
â”‚    logger.warn('Service failed', result.reason);                â”‚
â”‚    return null;  // Return null instead of throwing             â”‚
â”‚  };                                                              â”‚
â”‚                                                                  â”‚
â”‚  stats = {                                                       â”‚
â”‚    patients: extractData(results[0]),     // âœ“ Available        â”‚
â”‚    doctors: extractData(results[1]),      // âœ“ Available        â”‚
â”‚    appointments: extractData(results[2]), // âœ“ Available        â”‚
â”‚    revenue: extractData(results[3]),      // âœ— null             â”‚
â”‚    medicine: extractData(results[4])      // âœ— null             â”‚
â”‚  };                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Response to Client                             â”‚
â”‚                                                                  â”‚
â”‚  {                                                               â”‚
â”‚    "success": true,                                             â”‚
â”‚    "data": {                                                     â”‚
â”‚      "totalPatients": 15234,          // âœ“ From Patient Service â”‚
â”‚      "activeDoctors": 189,            // âœ“ From Doctor Service  â”‚
â”‚      "todayAppointments": 127,        // âœ“ From Appt Service    â”‚
â”‚      "patients": { ... },             // âœ“ Available            â”‚
â”‚      "doctors": { ... },              // âœ“ Available            â”‚
â”‚      "appointments": { ... },         // âœ“ Available            â”‚
â”‚      "revenue": null,                 // âœ— Service down         â”‚
â”‚      "medicine": null                 // âœ— Service error        â”‚
â”‚    },                                                            â”‚
â”‚    "warnings": [                                                 â”‚
â”‚      "Billing service temporarily unavailable",                 â”‚
â”‚      "Medicine service error"                                   â”‚
â”‚    ],                                                            â”‚
â”‚    "partial": true                                              â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Frontend Handles Partial Data                 â”‚
â”‚                                                                  â”‚
â”‚  if (response.partial) {                                        â”‚
â”‚    // Show warning banner                                       â”‚
â”‚    toast.warning('Some data temporarily unavailable');          â”‚
â”‚                                                                  â”‚
â”‚    // Hide unavailable sections                                 â”‚
â”‚    if (!data.revenue) {                                         â”‚
â”‚      hideRevenueWidgets();                                      â”‚
â”‚    }                                                             â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â”‚  // Display available data                                      â”‚
â”‚  renderAvailableWidgets(data);                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Benefits:**
- Dashboard remains functional even if some services are down
- No cascading failures
- Better user experience
- Clear visibility of service health

---

## ğŸ“ˆ Performance Metrics

### Response Times (Target)

| Scenario | Target | Acceptable | Notes |
|----------|--------|------------|-------|
| Cache HIT | <10ms | <50ms | Redis read |
| Cache MISS (all services up) | <300ms | <500ms | Parallel calls |
| Partial failure (2/5 services down) | <400ms | <800ms | Graceful degradation |
| Real-time event delivery | <100ms | <200ms | Socket.io |
| Service-to-service auth | <5ms | <10ms | Header validation |

### Cache Hit Rates (Target)

- Dashboard stats: 80-90%
- Patient growth: 95-98%
- Doctor top list: 90-95%
- System health: 70-80% (short TTL)

---

## ğŸ” Monitoring Points

1. **API Gateway:**
   - Request count per endpoint
   - Response times (p50, p95, p99)
   - Cache hit/miss rate
   - Error rate
   - Active Socket.io connections

2. **Individual Services:**
   - Admin endpoint response times
   - Database query performance
   - Error rates
   - Resource usage

3. **Redis:**
   - Memory usage
   - Key count
   - Hit rate
   - Eviction rate

4. **Kafka:**
   - Event throughput
   - Consumer lag
   - Failed messages

---

This comprehensive flow documentation should help understand exactly how data moves through your distributed system! ğŸš€